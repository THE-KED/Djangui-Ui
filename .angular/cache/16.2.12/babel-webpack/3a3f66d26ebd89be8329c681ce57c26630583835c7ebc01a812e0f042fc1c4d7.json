{"ast":null,"code":"import * as i0 from \"@angular/core\";\nclass CacheResolverService {\n  constructor() {\n    this.cache = new Map();\n    this.lats = \"\";\n  }\n  set(key, value, timeToLive = null) {\n    console.log(\"Set cache key \", key);\n    if (timeToLive) {\n      const expiresIn = new Date();\n      expiresIn.setSeconds(expiresIn.getSeconds() + timeToLive);\n      this.cache.set(key, [expiresIn, value]);\n    } else {\n      this.cache.set(key, [new Date(), value]);\n    }\n  }\n  get(key) {\n    console.log(\"Get cache key \", key);\n    const tuple = this.cache.get(key);\n    if (!tuple) return null;\n    const expiresIn = tuple[0];\n    const httpSavedResponse = tuple[1];\n    const now = new Date();\n    if (expiresIn && expiresIn.getTime() < now.getTime()) {\n      this.cache.delete(key);\n      return null;\n    }\n    return httpSavedResponse;\n  }\n  map(route) {\n    // if(route.endsWith(\"/Tontine/types\"))\n    //   return 6400;\n    // // if(route.endsWith(\"/membre/user\"))\n    // //   return 360;\n    // if(route.includes(\"participation/\"))\n    //   return 60;\n    return 0;\n  }\n  static #_ = this.ɵfac = function CacheResolverService_Factory(t) {\n    return new (t || CacheResolverService)();\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: CacheResolverService,\n    factory: CacheResolverService.ɵfac,\n    providedIn: 'root'\n  });\n}\nexport { CacheResolverService };","map":{"version":3,"names":["CacheResolverService","constructor","cache","Map","lats","set","key","value","timeToLive","console","log","expiresIn","Date","setSeconds","getSeconds","get","tuple","httpSavedResponse","now","getTime","delete","map","route","_","_2","factory","ɵfac","providedIn"],"sources":["/home/ked/backups/Angular/DanguiUi/src/app/Services/CacheResolverService.ts"],"sourcesContent":["import {Injectable} from \"@angular/core\";\r\nimport {HttpResponse} from \"@angular/common/http\";\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class CacheResolverService{\r\n\r\n\r\n    private cache = new Map<String, [Date,HttpResponse<any>]>();\r\n\r\n    private lats=\"\";\r\n\r\n\r\n  constructor() {}\r\n\r\n  set (key:string, value:HttpResponse<any>, timeToLive:number|null = null){\r\n    console.log(\"Set cache key \",key);\r\n\r\n    if(timeToLive){\r\n      const expiresIn = new Date();\r\n      expiresIn.setSeconds(expiresIn.getSeconds()+timeToLive);\r\n      this.cache.set(key,[expiresIn,value]);\r\n    }else {\r\n      this.cache.set(key,[new Date(),value]);\r\n\r\n    }\r\n  }\r\n\r\n  get (key:string) {\r\n    console.log(\"Get cache key \",key);\r\n\r\n    const tuple =this.cache.get(key);\r\n\r\n    if(!tuple) return null;\r\n\r\n    const expiresIn = tuple[0];\r\n    const httpSavedResponse = tuple[1];\r\n    const now = new Date();\r\n\r\n    if( expiresIn && expiresIn.getTime()<now.getTime()){\r\n      this.cache.delete(key);\r\n      return null;\r\n    }\r\n\r\n    return httpSavedResponse;\r\n  }\r\n\r\n\r\n\r\n  map(route:string):number{\r\n\r\n    // if(route.endsWith(\"/Tontine/types\"))\r\n    //   return 6400;\r\n    // // if(route.endsWith(\"/membre/user\"))\r\n    // //   return 360;\r\n    // if(route.includes(\"participation/\"))\r\n    //   return 60;\r\n    return 0;\r\n\r\n\r\n  }\r\n}\r\n"],"mappings":";AAGA,MAGaA,oBAAoB;EAQ/BC,YAAA;IALU,KAAAC,KAAK,GAAG,IAAIC,GAAG,EAAoC;IAEnD,KAAAC,IAAI,GAAC,EAAE;EAGF;EAEfC,GAAGA,CAAEC,GAAU,EAAEC,KAAuB,EAAEC,UAAA,GAAyB,IAAI;IACrEC,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAACJ,GAAG,CAAC;IAEjC,IAAGE,UAAU,EAAC;MACZ,MAAMG,SAAS,GAAG,IAAIC,IAAI,EAAE;MAC5BD,SAAS,CAACE,UAAU,CAACF,SAAS,CAACG,UAAU,EAAE,GAACN,UAAU,CAAC;MACvD,IAAI,CAACN,KAAK,CAACG,GAAG,CAACC,GAAG,EAAC,CAACK,SAAS,EAACJ,KAAK,CAAC,CAAC;KACtC,MAAK;MACJ,IAAI,CAACL,KAAK,CAACG,GAAG,CAACC,GAAG,EAAC,CAAC,IAAIM,IAAI,EAAE,EAACL,KAAK,CAAC,CAAC;;EAG1C;EAEAQ,GAAGA,CAAET,GAAU;IACbG,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAACJ,GAAG,CAAC;IAEjC,MAAMU,KAAK,GAAE,IAAI,CAACd,KAAK,CAACa,GAAG,CAACT,GAAG,CAAC;IAEhC,IAAG,CAACU,KAAK,EAAE,OAAO,IAAI;IAEtB,MAAML,SAAS,GAAGK,KAAK,CAAC,CAAC,CAAC;IAC1B,MAAMC,iBAAiB,GAAGD,KAAK,CAAC,CAAC,CAAC;IAClC,MAAME,GAAG,GAAG,IAAIN,IAAI,EAAE;IAEtB,IAAID,SAAS,IAAIA,SAAS,CAACQ,OAAO,EAAE,GAACD,GAAG,CAACC,OAAO,EAAE,EAAC;MACjD,IAAI,CAACjB,KAAK,CAACkB,MAAM,CAACd,GAAG,CAAC;MACtB,OAAO,IAAI;;IAGb,OAAOW,iBAAiB;EAC1B;EAIAI,GAAGA,CAACC,KAAY;IAEd;IACA;IACA;IACA;IACA;IACA;IACA,OAAO,CAAC;EAGV;EAAC,QAAAC,CAAA,G;qBAvDUvB,oBAAoB;EAAA;EAAA,QAAAwB,EAAA,G;WAApBxB,oBAAoB;IAAAyB,OAAA,EAApBzB,oBAAoB,CAAA0B,IAAA;IAAAC,UAAA,EAFnB;EAAM;;SAEP3B,oBAAoB"},"metadata":{},"sourceType":"module","externalDependencies":[]}