<div class="content">
  <mat-grid-list cols="10" class="main" rowHeight="5vh">

    <mat-grid-tile colspan="7" rowspan="5" class="main--wrapper">

      <mat-card class="main--card">
        <mat-card-header>
          <mat-grid-list cols="3" rowHeight="6vh" class="info">
            <mat-grid-tile colspan="3">
              <mat-card-title>{{epargne.nom}}</mat-card-title>
            </mat-grid-tile>
            <mat-grid-tile>
              <mat-card-subtitle>Cassation le {{epargne.dateCassation|date:"dd-MM-yyyy"}} </mat-card-subtitle>
            </mat-grid-tile>
            <mat-grid-tile>
              <mat-card-subtitle>Plafond de pret: capital X{{epargne.coefPret}}</mat-card-subtitle>
            </mat-grid-tile>
            <mat-grid-tile>
              <mat-card-subtitle>Cree le {{epargne.dateCreation|date:"dd-MM-yyyy"}} </mat-card-subtitle>
            </mat-grid-tile>
            <mat-grid-tile>Taux d'intert sur pret : {{epargne.tauxInteretPret}}%</mat-grid-tile>
            <mat-grid-tile>
              <mat-card-title>Caisse: {{getCaisseMontant()}} F </mat-card-title>
            </mat-grid-tile>
            <mat-grid-tile>
              <mat-card-title>Dettes: {{getPretMontant()}} F </mat-card-title>
            </mat-grid-tile>


          </mat-grid-list>

          <mat-card-subtitle></mat-card-subtitle>
<!--          <mat-card-title>{{getCaisseMontant()}}</mat-card-title>-->
<!--          <mat-card-subtitle>A Rembourser</mat-card-subtitle>-->

        </mat-card-header>
        <mat-card-content>
        </mat-card-content>

      </mat-card>

    </mat-grid-tile>

    <mat-grid-tile colspan="3" rowspan="13" class="rigth--form--wapper">


    </mat-grid-tile>

    <mat-grid-tile colspan="7" rowspan="15" class="table--wrapper">


      <mat-card class="table--card">
        <mat-card-header>
          <mat-card-title>Liste des epargnants</mat-card-title>
          <mat-card-subtitle>...</mat-card-subtitle>


        </mat-card-header>
        <mat-card-content class="table--card--content">

          <table  mat-table [dataSource]= "capitaux.slice()"  class = "mat-elevation-z8" >

            <!--- Notez que ces colonnes peuvent être définies dans n'importe quel ordre.
                  Les colonnes réellement rendues sont définies en tant que propriété dans la définition de ligne" -->

            <!-- Position Column -->


            <ng-container  matColumnDef = "no" sticky class="sticky--columns">
              <th  mat-header-cell *matHeaderCellDef class="sticky--columns"> No. </th >
              <td  mat-cell *matCellDef = "let element, index as i" class="sticky--columns"> {{i+1}} </td>
            </ng-container>

            <!-- Nom Colonne -->
            <ng-container  matColumnDef = "epargnants" sticky class="sticky--columns">
              <th  mat-header-cell *matHeaderCellDef class="sticky--columns"> Epargnants </th>
              <td  mat-cell *matCellDef = "let element" class="sticky--columns"> {{element.epargnant?.membre.nom}} </td>
            </ng-container>

              <!-- Symbol Column -->
              <ng-container *ngFor="let columns of daysColumns, index as j"  matColumnDef = "{{columns}}">
                  <th  mat-header-cell *matHeaderCellDef class="D--columns">
                      <div class="box">{{columns}}</div>
                      <div class="box">{{dimanchesDates[j]|date:"dd-MM-yyyy"}}</div>
                  </th>
                  <td  mat-cell *matCellDef = "let element, index as i" class="D--columns">
                      <div class="box b1 {{colorDept(epargnes[i][j])}}">{{epargnes[i][j]==0?"":epargnes[i][j]+" F"}}</div>
                      <div class="box b2 {{colorpret(isHavePret(element.epargnant.id,dimanchesDates[j]))}}">{{isHavePret(element.epargnant.id,dimanchesDates[j])}}</div>
                  </td>
                  <td mat-footer-cell *matFooterCellDef >0</td>
              </ng-container>

            <!-- Colonne de poids -->
            <ng-container  matColumnDef = "total" stickyEnd>
              <th  mat-header-cell *matHeaderCellDef class="sticky--columns"> Total </th>
              <td  mat-cell *matCellDef = "let element, index as i" class="sticky--columns">
                  <span class="box">
                    {{element.capital}}
                  </span>
                  <span class="box">
                    {{element.dette}}
                  </span>
              </td>
            </ng-container>
              <ng-container  matColumnDef = "interert" stickyEnd>
                  <th  mat-header-cell *matHeaderCellDef class="sticky--columns"> Interet </th>
                  <td  mat-cell *matCellDef = "let element, index as i" class="sticky--columns"></td>
              </ng-container>

            <tr  mat-header-row *matHeaderRowDef = "displayedColumns; sticky: true"> </tr>
            <tr  mat-row *matRowDef="let row; columns: displayedColumns;"> </tr>
          </table>

        </mat-card-content>

      </mat-card>

    </mat-grid-tile>




  </mat-grid-list>


  <div class="pan" *ngIf="authService.role.includes('BUREAU')">
    <mat-card class="pret--card">
      <mat-card-header>
        <mat-card-subtitle>Effectuer une Operation</mat-card-subtitle>
        <mat-card-title>Operation</mat-card-title>

      </mat-card-header>
      <mat-card-content>
        <mat-form (submit)="deposit()" [formGroup]="formDep">
          <mat-tab-group [(selectedIndex)]="index">
            <mat-tab label="Pret">
              <div class="pret--wrapper">
                <mat-grid-list cols="4" rowHeight="85px" >

                  <mat-grid-tile colspan="4">
                    <mat-form-field floatLabel="always" appearance="outline">
                      <mat-label>Membre</mat-label>
                      <mat-select required [(ngModel)]="emprunteurId" [ngModelOptions]="{standalone: true}" (ngModelChange)="checkTontine()">
                        <mat-option *ngFor="let epargnant of dataSource" value="{{epargnant.id}}">{{epargnant.membre?.nom}}</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </mat-grid-tile>


                  <mat-grid-tile colspan="4">
                    <mat-form-field floatLabel="always" appearance="outline">
                      <mat-label>Montant</mat-label>
                      <input matInput type="number" class="example-right-align" placeholder="0" formControlName="montantPret">
                    </mat-form-field>
                  </mat-grid-tile>

                  <mat-grid-tile colspan="4" *ngIf="epargne.type?.code==2">
                    <mat-form-field appearance="outline" floatLabel="always">
                      <mat-label>delais</mat-label>
                      <input matInput  type="number"  class="example-right-align" placeholder="" formControlName="delais" required>
                      <span matTextSuffix>Mois</span>
                    </mat-form-field>
                  </mat-grid-tile>

                  <mat-grid-tile *ngFor="let gage of garranties" colspan="4" rowspan="2">

                    <div class="garrantie--element">
                      <mat-label>type garrantie</mat-label>

                      <mat-radio-group aria-label="Select an option" [(ngModel)]="gage.type" [ngModelOptions]="{standalone: true}">
                        <mat-radio-button value=1>Tontine</mat-radio-button>
                        <mat-radio-button value=2>Membre</mat-radio-button>
                        <mat-radio-button value=3>Autre</mat-radio-button>
                      </mat-radio-group>


                      <mat-form-field *ngIf="gage.type==1" floatLabel="always" appearance="outline">
                        <mat-label>Tontine</mat-label>
                        <mat-select required [(ngModel)]="gage.tontineId" [ngModelOptions]="{standalone: true}">
                          <mat-option *ngFor="let tontine of tontinesGageble" value="{{tontine.id}}">{{tontine.nom.slice(15)}}</mat-option>
                        </mat-select>
                      </mat-form-field>

                      <mat-form-field *ngIf="gage.type==2" floatLabel="always" appearance="outline">
                        <mat-label>Membre</mat-label>
                        <mat-select required [(ngModel)]="gage.epargnantId" [ngModelOptions]="{standalone: true}">
                          <mat-option *ngFor="let epargnant of dataSource" value="{{epargnant.id}}">{{epargnant.membre?.nom}}</mat-option>
                        </mat-select>
                      </mat-form-field>

                      <mat-form-field *ngIf="gage.type==3" appearance="outline">
                        <mat-label>Autre</mat-label>
                        <input matInput  type="text" placeholder="Garrantie" [(ngModel)]="gage.autres" [ngModelOptions]="{standalone: true}">
                      </mat-form-field>

                    </div>
                  </mat-grid-tile>

                  <mat-grid-tile colspan="4">
                    <button mat-flat-button color="primary" (click)="addGage()"> Ajouter une garrantie</button>
                  </mat-grid-tile>
                </mat-grid-list>
              </div>

            </mat-tab>
            <mat-tab label="Depot">
              <mat-grid-list cols="4" rowHeight="85px">

                <mat-grid-tile colspan="4">

                  <mat-form-field class="example-full-width" appearance="outline">
                    <mat-label>Membre</mat-label>
                    <input type="text"
                           placeholder="Membre"
                           aria-label="Number"
                           matInput
                           formControlName="membre"
                           (keyup)="applyFilter($event)"
                           [matAutocomplete]="auto">
                    <mat-autocomplete #auto="matAutocomplete">
                      <mat-option *ngFor="let member of dataS" [value]="member.nom">{{member.nom}}</mat-option>
                    </mat-autocomplete>

                  </mat-form-field>
                </mat-grid-tile>

                <mat-grid-tile colspan="4">
                  <mat-form-field floatLabel="always" appearance="outline">
                    <mat-label>Montant</mat-label>
                    <input matInput type="number" class="example-right-align" placeholder="0" formControlName="montant">
                  </mat-form-field>
                </mat-grid-tile>
              </mat-grid-list>

            </mat-tab>
          </mat-tab-group>
        </mat-form>

        <mat-divider></mat-divider>
      </mat-card-content>
      <mat-card-actions>
        <button mat-flat-button color="primary" (click)="deposit()" [disabled]="!btnIsDiable()">Confirmer</button>
      </mat-card-actions>
      <mat-card-footer>
      </mat-card-footer>
    </mat-card>
  </div>



</div>

